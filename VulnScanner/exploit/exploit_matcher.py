# Vuln Hunter - Exploit Matcher
# DO NOT USE ILLEGALLY. Only scan networks you own or have permission to scan.
import asyncio
import re
from typing import List, Dict

async def search_exploits(cve_list: List[str]) -> Dict[str, List[str]]:
    """
    Search for exploits matching given CVEs using searchsploit.
    
    Args:
        cve_list: List of CVE IDs to search for
    
    Returns:
        Dictionary mapping CVEs to exploit paths
    """
    results = {}
    
    for cve in cve_list:
        cmd = f"searchsploit --cve {cve} -j"
        
        try:
            proc = await asyncio.create_subprocess_shell(
                cmd,
                stdout=asyncio.subprocess.PIPE,
                stderr=asyncio.subprocess.PIPE
            )
            
            stdout, stderr = await proc.communicate()
            
            if proc.returncode == 0:
                output = stdout.decode()
                # Parse searchsploit JSON output here
                exploits = re.findall(r"Exploit: (.+)", output)
                results[cve] = exploits
                
        except Exception as e:
            continue
            
    return results